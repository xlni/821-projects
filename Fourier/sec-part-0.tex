\section{First properties of conical subsets}\label{sec:part0}

Let $V$ be an $\F_p$ vector space.
Throughout the rest of paper, for all such $V$, we implicitly pick an isomorphism 
	$V\cong\F_p^n$, i.e., an explicit basis. This
	entitles us to an inner product on $V$, as well as an isomorphism between $V$ and
	$V^*$, where all functionals are of the unique form $x \mapsto \langle v, x \rangle$
	for some $v\in V$.

We are interested in indicator functions of conical subsets of $V$:
\begin{defn}
    A subset $S\subset V$ is called \emph{conical} if it is closed under scaling,
    i.e., for all $x\in \F_p$, $xS = S$.    
\end{defn}
Since we're studying indicator functions, we can simplify our expression for 
$\widehat{\IND_S}$:
\[ \widehat{\IND_S}(\xi) = \sum_{x\in S} \exp \left(\frac{2\pi i}{p} \xi(x)\right). \]
Noting that $\IND_S = 1 - \IND_{V\setminus S}$, we can further write the Fourier transform as
\[ \widehat{\IND_S}(\xi) = 1 - \sum_{x\not\in S} \exp \left(\frac{2\pi i}{p} \xi(x)\right), \]
which will be occasionally convenient. The following lemma further reduces this expression,
which will be useful throughout the paper.
\begin{lem}\label{lem:FT-conical-subset}
	For a conical subset $S \subset V$,
	\[ \widehat{\IND_S}(\xi) = \frac{p|S \cap \ker \xi| - |S|}{p-1}. \]
	\begin{proof}
	   The key insight is that a conical set can be viewed as a collection of lines.
	   Define $S\P = (S\setminus\{0\}) / {\sim}$, where we declare that 
	   $x \sim \lambda x$, for all $\lambda\in\F_p^\times$ and
	   $x\in S$ (as one might define projective space). Let $[x]$ denote the class
	   of $x$ in $S\P$. We can then write the Fourier transform as follows:
	   \[ \widehat{\IND_S}(\xi) = 
	           1 + \sum_{[x]\in S\P} 
	               \sum_{\lambda\in\F_p^\times} \exp \left(\frac{2\pi i \lambda}{p} \xi(x)\right) \]
	   If $\xi(x)$ vanishes, then the inner sum is just $p-1$; if it doesn't, then it's
	   a sum of equal powers of all the roots of unity, except $1$, so the inner sum is $-1$.
	   Thus,
	   \begin{eqnarray*}
	       \widehat{\IND_S}(\xi)
	       &=& 1 + 
	           (p-1)|S\P \cap \ker \xi| - 
	           |S\P \setminus \ker\xi| \\
	       &=& 1 + 
	           (p-1)|S\P \cap \ker \xi| - 
	           (|S\P| - |S\P \cap \ker\xi|) \\
	       &=& 1 + 
	           p|S\P \cap \ker \xi| - |S\P|
	   \end{eqnarray*}
	   Note now that $|S\P| = \frac{|S| - 1}{p-1}$, by definition. If we substitute
	   this in, we find that 
	   \[ \widehat{\IND_S}(\xi) = \frac{p|S \cap \ker \xi| - |S|}{p-1}, \]
	   as desired.
	\end{proof}
\end{lem}

The simplest conical set is a linear subspace $W$ of $V$.
To show the power of Lemma \ref{lem:FT-conical-subset}, we use it to compute $\IND_W$
as a warmup. Let $W^\perp$ denote the \emph{annihilator} of $W$ in $V^*$, that is, the
subspace
\[ W^\perp = \{ \xi \in V^* \,|\, \xi(x) = 0 \text{ for all } x \in W \}. \]
It turns out that this subspace is related to our original $W$ by way of the Fourier
transform.

\begin{thm}\label{thm:FT-subspace}
    $\widehat{\IND_W} = |W| \IND_{W^\perp}$.
    \begin{proof}
        By Lemma \ref{lem:FT-conical-subset}, we need only compute what 
        $|W\cap\ker\xi|$ is. Consider $\xi$ restricted to $W$. By the dimension theorem,
        \[ \dim W = \dim \ker \xi + \dim \img \xi, \]
        and since $\xi$ is a functional, we have two options for $\dim\img\xi$.
        If it's $0$, then $\xi$ kills all of $W$ and thus is in $W^\perp$; 
        $|W\cap\ker\xi| = |W|$ and thus $\widehat{\IND_W}(\xi) = |W|$. If it's $1$,
        then there's some $x\in W$ which $\xi$ does not kill, so $\xi\not\in W^\perp$.
        Moreover, the dimension theorem says that $|W\cap\ker\xi| = |W|/p$, so 
        $\widehat{\IND_W}(\xi) = 0$.
    \end{proof}
\end{thm}
